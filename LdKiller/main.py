import psutil
import time
import win32serviceutil

from PyQt5.QtWidgets import QMainWindow, QApplication, QSystemTrayIcon, QStyle, QMenu, QAction
from PyQt5.QtGui import QPixmap, QIcon

icon_data = b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00@\x00\x00\x00@\x08\x06\x00' \
            b'\x00\x00\xaaiq\xde\x00\x00\x00\x04sBIT\x08\x08\x08\x08|\x08d\x88\x00\x00\x00' \
            b'\tpHYs\x00\x00\x01\xd8\x00\x00\x01\xd8\x01\xfa\\\xa6r\x00\x00\x00\x19tEXtSoftware' \
            b'\x00www.inkscape.org\x9b\xee<\x1a\x00\x00\x0f\xb3IDATx\x9c\xed\x9by|TE\xb6\xc7\xbf' \
            b'\xd5\xdd\xe9\xce\xd2Y\xe8\xac \x84\x84\xb0\x04\x08\xb2\xc9C\x04TV\x95UYF\x06p\xdc\x18P' \
            b'\x11\x88\xca\x88\x82\xc3(\x0e8l:\xbe\x87>D\x1dG\x1d\x9e\x0b\xce\xa8\xe3\xc0S\xc0qAD' \
            b'\xd9\t\x84\x90\x18HHB\xd2\xd9\x08Yz_\xea\xfdq\xbb\xb3\x90\xa5\xbb\x13\xc4\xf7\xde\xf8' \
            b'\xfb|\xee\xa7o\xeaV\x9d:\xe7w\xebV\x9ds\xaa\x02?\xe3g\xfcKC\\\xc5~\xa2\x80\x10 \xd8G]\'P' \
            b'\x0bH\xe0\xd2\x8f\xac\xd7\x15#\xa0\x0b0\x18\xe8\x05\xf4\xf4\\)@4\x10\x06h; \xbb\x1a(\x06\x8c@!p' \
            b'\x1a\xc8\x00Ny\xfe\xee\x10\xdaK@\x140\x06\x18\x07\x8c\x05\xfa6\x97,\x08\x8e' \
            b'\x88 (8\x04\x8dNGpD$\xea\xa0 \xb4\xa1am\nvZ\xad8l6\\.\'\xb6\xba:,U\x17\xb1\xd7' \
            b'\xd5\xb6V\xfd<\xb0\x17\xd8\x03|\x8aBV@\x08\x84\x00\x01\xdc\n,\x00&\x03:\xef' \
            b'\x83\xb8^}H\x1cv=\x86\xa4d\x0c\xdd{(\xbf\x89Iht\xba\xd6d\x05\x04\x87\xc5Bm\x99' \
            b'\x91\x8bEE\x14feb\xcc9Cif\x06\xd5\xd9YH\xb7\xcb\xa3\x9d\xb0!\xe5G\xc0\x1b\xc0n\x94O' \
            b'\xc8/\xa3\xfc\xc1\x08`\x1b\x90\x06\xa0\x0b\x0f\xa7\xffm\xd3H\x1e9\x9a\xe4\xebG' \
            b'\xa1\x8f\x8d\x0b\xd4\xa6\x0eC\x02\x15\x95\x17\xc9\xfc\xe6+\xce}\xfd\x05%{w\xe1' \
            b'\xa8\xad\xf1>>\x0e\xac\x03>\xc0\x07\x11~\x11\x10\x93\xd2\xf3\xbf+\xce\xe6\xde\x9a\xd0/\x8da\xf3\xeea\xc0\xf4YhCC;\xa2\xff\x15\x85\xcd-)\xae5qj\xf7.\xce\xfd\xe5u\xaaN\x1e\xf3>\xda\x07,\x06N\xb6\xd6\xb65\x02\x040\x7f\xe0\xb4\x19Ew\xbc\xb8\xf5a\xbb\xc9<\xa3\xba\xb8\x88\xd8\x9e\xbd\xaf\xac\xe6W\x18f\x97\x9b\x02\xab\x83\xf3\xdf\xee\xe3\xf4\x0bk\xa9>\x93\tB8\x91r9\xf0bKmZ"@\x07\xbc\x0e\xccK\x9d8\xc9:g\xeb\x9f}-[-\xc2i\xb7S\x9au\x8a\xe2S\x19T\x9e\xcb\xa5\xb6\xd4\x88\xa5\xda\xf7\xaa\xa6\xd2h\xd0\x85\xe9\t\x8fO :9\x85\xf8\xbe\xfd\xe9:h\x08*\xb5\xc6\xaf~%PlsPb\xb1\x91\xff\xde\xdbd\xfd\xf19\\6+\xc0\xbb\xc0\xdd\x80\xbdq\xfd\xcb\t\xd0\x02\x1f\x01\xb7Eu\xed\xc6\xfc7\xde%&\xa5\x97\x7f\x1dK\xb0\xb8\xddd\x7f\xbb\x8f\xd3\x1f\xed \x7f\xf7.\x1c\xa6:\xbf\xda\xfa\x826,L\xf6\x1e3A\\7\xef\x1e\x92\x86\xdf\xe0W\x9bJ\xbb\x8b\xf36;\xd5gNs\xe8\xb1E\x98\x8b\n\x00v\x013\x00\x9b\xb7\xde\xe5\x04l\x07\xe6\xc6\xa7\xf6\xe3\xae\xb7v\xa0\x8f\x89\xf5\xd9\x91\xcd-)\xb7;9\x9f\x9d\xcd\x89Mk(\xdb\xff\xa5G\xb2\xb0 e\x88&&\x8e\xd8\xf4U\x04\xc5%\xa0\x8e2\x80J\xd5\xa6<\xa3\xd5\x81\xe5b%\x94\x1ba\xf3j0\x9b\xdc\x80\x05\xc5\x9f\xa0\xfb\xbf\x8d`\xea\xba\xcd\xc4\xf4\xe8\xe9\x9b\x04\x87\x93|\x8b\x03[E9\x07\x1e\x98Gmn6\xc0[(#\xa1\x19\x01\x8b\x81-Q]\x13\xe5\xfd\x1f\xec\x14\xe1q\xf1m\n\x97\x12J\xecNJm\x0eJ\xbf\xff\x86C\xcb\x16\xe0\xb2Z@qT\xd6\xa1,Ee\xda\xe4^$m\xdf\xe9SY/\x8alN\xcc.\xb7\xf2\xc7\xcc\xd1P]e\x02\xe2\x81\xdb\x81\x95@?\x8dV\'\xe7\xbc\xf2\xa6\xe8y\xd3X\x9f\xf2JlN\x8am\n\t\xfb\xee\x9a\x8e\xa5\xe4\x02\xc0C\xc0\x7f\x02x_G"BlT\x07\x05\xc9_\xbc\xf4\x9ao\xe3\x91\xe4Y\xec\x94\xd8\x1cT\x1c?\xcc\xa1\xa5\xf7\xe3\xb2Z$\xf0$0\x10e$\x99\xfd\xb6\xda7L\x1e\x99\x03\x81\x95N\xbb\x8dw\x1f\xb8[\x16\x1d?\xea\xb3ag\x9d\x06\xbdZ\x85.&\x96\xeb6\xbe\x8cP\xa9\x11Bl\x02\xbaA\x03\x01k\x912d\xe4\xa2%\xa2\xcb\x80A>\x85\x16[\x9dT9]H\xb7\x9b\x13\xcf\xac\xf0N2K\x81?\xa0\xf8\xf2?\x16\x9c\xc0s\xc02\xa7\xcd&>}v\x15R\xfa\xf6w\xba\x05\x07\x01\x10\x956\x88\xa49\xbfBJ\x19\n\xac\x01\x85\x80D`NpD$\xa3\x1eX\xe2S\x98KJ\xca\x1c\x8a\x8d\x95\x87\xbf\xa3./\x17\xe0 \xf0R{,j\'\xb6\x00\x87\x8a\x8e\x1d\xe1\xfc\xc1\x03>+\x87\xaaUDj\xd4\x00\xa4.^\x8e6\xca\x00B\xcc\x05\x0c*`\x0e\xa0\x190m\x86O?\x1d\xa0\xce\xe5\xc6\xed!\xfd\xe2\xb1C\xdeb\x9f\x1e\xd7\x15\x86\xf4\xf4I\xc1\xa1\xef\xfcj\x10\x1d\xa4\x10\xa0\t\xd3s\xcd\xa4\xe9 \xa5\x16\x98\xadA\xf1\xef\x198\xe3N\xbf\x049\x1b\x99\xe9\xa8\xa9\x8f=\xf2\xfcj\x0c\xb8.Ua\xcb\xc9\xc4~\xa1\x10\xb7I\tr\xd4\xe1\x91\x04u\xedNp\x9f~\x10\xe4\xb7\x87y\x0e\xc0|\xa9\xca\xaf\xca\x91\x1a5*\x01n\t]\xa7\xcc \xef\xbf\xde\x00\xb8]\x03\x0c\x10*5\t\xfd\xd2Zm\\[V\xca\xc5\xfcsT\xe6\x9f\xc3\x98w\x8e\xc2\xb3\xb9\x98\n\xf21\x15\xe4{\xab$\xb6\xd5\xb9\xdbTG\xf5\';\xa8\xdd\xbb\x13k\xd6Ie\ti\x01B\xa5B\xa4\r\x861\x93a\xe2t_6%\x02\x1c\xde\xfeg\xf2\xf6\x7f\xad\x04`I=0tO&:I\t\xc8"\x12\xba\xd4WV\t\xd0\t\x81EJ"z\xf5E\xa8\xd4H\xb7\xab\xb7\x06\x88\xd0\xc7\xc4\xa0\xd1j\xeb\x8d\xbdp\xfc(E\xc7\x0fSt\xec\x08%\xa72\xb0\xb5\xe2\xd0\xe8T\x1a<\xb1XrkZ:\x8d\x17\xc8\x9bq3.O\xa0r\xcd5\t\x8c\xbbi$\xdd\xbbw%6\xda\x80\xd3\xe5\xa4\xb8\xd8\xc8\xf9\xf3\x85|\xb1\xef{*2\x8e@\xc6\x11\xc4\x9b[\x90fS[\x04$\x03h]NJ\xb3\xb3(\xcd\xcejVA\x1b\x12J\xe7\xb4k\xe9:x(]\x07\x0f\xc3\xd9\'\r\x0c\xb1\xa8\x82\x82\xd0\x19\xa2\xb1V\x94]#\x80\xf3\x1a\x9d.\xb1\xcf\xf8[):v\x98\xea\xe2\x0bM\x84\xe8\xb5A\xf4\x8e\n\'%RO\xcf\xa8pzF\xe9I0\xf6\'Y\x17C\xb1\xbd\x86\xf1\x19[A\xf1\xb0&_\xd6\x7f\x1f\xe0\x0c\x80&H\xc3\xdc\xd9\xd3Y\xfa\xd0}\x0c\xbc\xb6_\x8b\xd6H$6\x93\x89\xfd\x07\x0e\xb2\xf5\xf5w\xf8x\xd7\xe7\xde\x19\xde\x8e\xf2\xb6K/k\xb2\x13\x98t\xf0\x97\xb7\xd05,\x94\xb3\xd5u\xe4^\xaa%\xb7\xba\x96\xdcK\xca\xfd\x0f\x97j\xa9\xb1;\x9a4\n\x89\xefL\xa7\x81C1~\xb5\x07\xb7\xcdV*\x80\xaf\x81\xd1\x00j!\xe8k\x88`X|4\xc3\x13b\x18\x96` \xb5S\x04*\xd1\xd4a\xac9\x99\x82\xdb\x16D\x9d\xcbN\xafC\xcf\x01d\x01\x8d-\xbbV\x08>\x93\x92\x84\xe1\xc3\x06\xf3\xe6\xab/\x90\xd2\xa3{\x8b\x86_\x0e\xb7\xcb\x89\xddR\xc7\xa1\xa3\'I_\xb1\x96\x8c\xccl\x84\x10g\xa5\x94\x13\xf1|\xf7\x1e\x9c\x06\xfa\x96-\x9cI\xb8\xb6\xe58\xc1-%\xd9U\xb5\x1c*\xad\xe4\xfb\x92J\x0e\xe4\xd7\x92c)\xc7\xd5\xf0\t~#P\xd6\xee\x15\x0f\x0f\xec\xcd\xea\xe1\x03Z\x15\xd6\x18u9\xddp\xd6(+F\xff\xc3\x1b\xa9rY\xccRJ\xef\x12\xd2W\x08q@J\x19\xb9\xe4\xc1{\xd9\xb0v%\x1a\x8d\x7f\x81\x8c\x17\xd2\xed\xc2f\xa9\xc3l2\xb3h\xd9j>\xda\xb9\x17!D\x89\x94r\x18\xe0\x1d\xa2\xa6\xe8\x10]h\xd1\xfd\xb7\xfb%\xd3e\n\xa66+\x89:\x97\x9d\r\x85\xff\xe4U\xe3\xf7\x00\x1bT(\xa9$2*.\xf9e\xbc\xa2\xa0\xe2?\x19\xed\xb5X\xdc\x0eh\xf0\xfa\xc2\x80\x0f\xa4\x94\x91\xcb\xd3\x17\xf1\xfc\xfa\xd5\x01\x1b\x0f Tjt!zBCBx\xf3\x95\xf5\xfcr\xd6\x14\xa4\x94\x9d\x81\xf7\x80 O5\xab\xd5\xe9\xc2h\xb2\xf8%\xd3\xe1yaz\xb5\x96Ls\xfd\xd7\xf4w\x01h\x04\x14\t!\xe2\x7f\xb8g*]\xc2B\x9a5vKI^\x8d\x89\xd3\x95\xd5\x9c*tp\xaa\xc4L\x8e\xa5\x9c\x1cK9v%%\xb5\x19X\x0el\x05\x16M\x9d4\x9e\xbf\xbe\xb3\r!:\x96su9l\xd8\xadflv;\x93g-\xe4\xe0\x91\x0cP<\xb8\xdf\x01\xcf\x03\x8f\xe8\xd4jR\r\x11\xf45D\xd0\xcf\x10I\xaa!\x82\xfe\x86H\x92"\xc2\x9a|\xba\xb5\x99=pY\xb4\x18\xed\xb5\x0c=\xfa\x02RP \xa5L\xf2\xd6\xd8\x08,\x9f\x97\x9a\xc4\xb2\xc1}8_c"\xab\xa2\x8e\xcc\xf2Z\xceTU\x93]s\t\xab\xab\xb9\x87\xab\x12\xa2\xcc-\xe5k\x1e\x85z\x00\x99q\xb1\xd1\xea\x13\x07\xf7\x88\x98\xe8N\x1d2\xde\x0b\x9b\xa5\x16\xb7\xd3IAa1Co\x9c\x81\xdd\xe10I){\x00\x17=d\xdc\x87\x12,5A\x88FM\x9fN\n1\xa9\xfa\x18\xba\xd7\xf5\xa2\x9b.\x8a\xad%\x07\xd8Q~\x02`=\xf0\x84\x97\x80\x04!D\xa6\x94\xd2\xd0\x92\x12B\x88*)\xe5)\x94\x89\'\xb3\xd1\xaf\xb1Q\xb5\xed\xc0\xdc\x8d\xebV\x91\xfe\xf0\x82+b<\x80\xdb\xe9\xc4fQ\x1c\xa6\x95\xcf<\xcf\x96m\x7f\x81\x86\x11\xe7E\x02\xd0\x1fe"n\xfc\xdb\xa2=*\x95\xea\xa2\xdb\xedN\x03J\x1a\x8f\xd1d\xe0q\x947\x99G\x83\x91\x97\x1b\xda\x12B\x81\x8aN\x9d"\x83\xf3\xb2\xbe\x15a\x8d\xf2\x85e\xe5\x95\xa4\xff\xe6w\x9c=WP_&\x04\x8c\x18>\x94\x8d\xebV\x91\x97_\xc83\xeb^\xe0\x99\xa7\x1e\xab_)\x8aKJy|\xd5Z\x96/[\xc4\xa0\x81\xfd\xb1\x99jq\xbb\x9dTTV\xd1{\xc8D\x9cNW\t\xd0\x15p\xfb\xd0\xebrb\x92\x81\\\x14\x02\xcf\xb5\xd1.`\xdc\x0e\xc8\xf9s\xee\x90\x8e\x9a\xbc&\xd7\xaa\x15K$\x8a\xef\xde\xec\xfa\xeb;\xdb\xe4\xfa\xdf\xaf\x94\x80\xdc\xf2\xfc\xb3\xf5m\xfe\xf4\xcaf\t\xc8\xd5O\xa6KGM\x9e4W\x9c\x965\x17\x8e\xca\x9a\x0bG\xe5\x8d7\x0c\xf3\xb6\xbf\xfeJ(\xdevz\xc6?\x84\xe2\x19\x8e\x13\xc6\xdf\xd8\xec\xe1\xb4\xc9\x13\xb8{\xfel\xf2\xb2\x0ePVp\x9c\xb2\x82\xe3<\xfe\xe8\x83\x00TU]\xc2\xedV^b\xe3\xb0Vz\xcb<\xf1\x95Z\x1dT\xff\xec\xb6\x89\xf5}\xac\xa2aEh7\x02_\xa3\x9aB\x0b\xec\x00F\x02\xf4Om\x9e5\x1e2h\x00\xaf\xbd\xbc\xa1IYp\x80\x1b&B\xa5\xae\xbf\xef\x95R\xefPM\x01\xdeA\x89f\xdb\x9d\x83\xe8\x08\x01j\x14\xe3\'y\x0b\xe2\xe2b\x9aU:\x93\x9d\xcb\xcc\xb9\x8b\xc8\xf9\xa1\xf9\'\xa7\xd7\xeb1\x9b\x95u|\xc5S\xcf\xb1\xfa\xd9\xcd\x00\xd8/s_\x1b/\xa7\t\xf1M\xf2\x943Q6l\xee\xa7\x9d\xe1xG\x08x\x11\x98\xa6ML\xc6m\xb5\xe0,3\x12\x1e\xaeoV\xe9\x8d\xb7\xdf\'\xe7\x87s$\xc4\xc7\x12\x12\xd2\xe0c\x0c\x19\xd4\x9f\xc9\xb7\x8e\xc5d6\xf3\xe1\'\x9fq\xfcDf\x9b\x9d\t\x04\x12I\x84\xde\xd3G\xb7d\xb0Z\xa0\xdcx/\xca\x84\xf6\xfb\xf6\x18\xd1^\x02f\x01\x8bUa\xe1t\xd9\xb0\x15\xe3\xd3\x8f\xe1,3RZZ\x8e\xfe2\x9f\xdfbU2\xd0\xafl\xf9\x03\x93ni\x9e\xc4\x0c\x0e\xd6\xb1\xfb\x93\xedM\xca\xde\xda\xfe\x01\xf7?\xf8\x9b\x86\x02)\xeb\xe7\x83\xd2\xf2\n\xa5\xec\x9aDX\x90\x0eK\xef\x02\x8b\xe9\x19\xa4\xfc\ne\'( \xb4g\x12\x8c\x02\xf12B\xd0\xf9\xe9Mh\x13\x93\xd1x\xe2\xee\x12cY\xab\x8dJK\xcb\xc9\xcb/\xa8\xbfJ\xcb*\xfc\xee\xd0\xddht\x97\x94\x96+\x8a\xc7w\x81\xa4^\x90\xfe[\x90R\x85\x10O\xb4\xc3\x96v\x8d\x80\'A\xc6\x86O\x98J\xd8\xc81\x00\x04\xf7\xeeG\xdd\x97\xbb\xf9\xee\xe0QF\xdd0\xacI\xe5\xb8\x98h\x00\x16>\xdcT?!\x04\x9f~\xfc6co\x1e\xd9\xac\x03\xe1\xd9;P\t\xe5W:\x1b\xe6\xb8\x83\x873\x00\x08\xef\xd3O\xd9\x0b\x1f;\x19\x10\x84\xc6\xc4X\xcd\x8f\xde\x17\xb01\x81\x12\x10\t<(4\x1ab\x16,\xad/\x0c\x1b5\x8e\x8am\x7f\xe4\xef;\xf7\xb0<}Q\x93\x06K\x1e\xba\x97\xb2\x8aJr~8\xdb\xa4<\xda\xd0\x89\xb4\xfe\xa9-v2~\xcc(f\xcf\x98\xcc\xac;\x94\xf9\xd5\xd5\xc8\r\xdf\xf9\xd9\x97\x08\x95\x8a\xe8\xd1c\xb1\xa8\x04v\xb7\x84\xb1\x93\xb0\x0b1-\xe9\x8b/\x82\xf3\xc7\x8c\xb1\x06bP\xa0\xd1\xca"`k\xe4\x94Y\xc4\xaf\\\xd7\xe4A\xde\xacq\xb8\x8c\x17\xc8<\xf29=S\x92\x02\x14\xdb:$\x12[]5RJ\xbe?|\x82\t\xd3\xef%8m0\x89\xdb\xde\xa3\xca\xe1\xa2\xdc\xe1\xc9I\x95\x95\xa0y:\xfd\x8c3\'\xf3N\x94\x13$~!\xd09\xe0N\x00\xfd\xb8\xdb\x9a=\x88\x9a1\x17\xb7\xdb\xcd\xeag7\x05(\xb2m\xb8\xec\xb6z\'\xe9\xe9\xe7\xfeC\xe9k\xe6\\\x00\xc25\xea\x86WXp\x0egNf*\xb0,\x10\xf9\x81\x10\x10\x0c\x8cP\x85\x84\x12:dx\xb3\x87Q\xb3\xe6\x13\x14\xdf\x85\x0f>\xdc\xc5\xbe\xfd\x07\x03\xd1\xa1UH)q:\x94U\xe4\xc3\x7f\xeca\xffwG\xd1\xf5\xeeG\xc4\x84\xa9\x80\x12\xc7\xeb\xbc>B\x9f4\x10*@\x8c\t\xa4\x8f@\x08H\x03\x82C\x06\rC\x045?\xf3$\xb4:b\x1eZ\x8e\x94\x929w/\xa6\xa0\xa88\x10=Z\x84\xc3fB\xba\xddde\x9fe\xf1ck\x10*\x15\xb1K\x9fh\xb2\xc1\x1a\xec\xbd\x0f\x8f\x84\x1e\xbd\x01\x99\x8c\x12(\xf9\x85@\x08\xe8\x05\xd4/y-!|\xc2\x14\xa2f\xff\x8a\xb2\xb2\n\xee\xb8s\x01F\xcf\x92\xd5\x1e8\x1dV\\\x0e\x07\xf9\xe7/p\xe7\xbd\x8fPWg"z\xe1#\x84\x0ei\x1a\x03i\x1b[\xd0=\xc5{\xd7f\x9a\xbe1\x02! \x16@\x13\xdd\xf6\x96y\xec\xd2\'\t\x1b>\x9a\x8c\x93Y\x8c\xb8y:\xc7N\x9c\n\xa0\x0b\x05N\xbb\r\x87\xd5\xc2\xbe\x03\x87\x193\xe5.\xf2\xcf\x17\x11q\xcbt\x0cw-lVW\xd38\xeb\x14U\x9f\x84\xf1\xbd\xaf\xefA \x04\x84\x01\xa8;E\xb7YI\xa8\xd5t\xd9\xb0\x95\xc8)\xb3(\xbaP\xc2\xe8\xf1\xb3X\xf1\xd4:.V\xf9>\x1d"\xa5\xc4n5SXX@\xfa\x8a\xb5L\x9f\xf3 \x95\x17/a\x98\xbf\x90\x84\xdf\xaeW\x12\tm\x19\x10\x1e\xe9\xbdk1\x11\xd2\x12\x02\xf1\x03T\xa0\x18\xe8\x0b"(\x88\xf8\x95\xeb\xd0\xf5\xeeG\xc5\xd6\xcd<\xff\xef\xaf\xf2\xa7\xb7\xde\xe7\x173\xa70}\xcaDn\x1e=\x02\xad\xb6Q$+\xa1\xd6T\xc3\xee\xcf\xbe\xe0\x1f\x9f\xfe\x93\xbf}\xb2\x07\xb3\xd9\x82&\xaa\x13\x9d\xd3\x9f"|\xe2T?5\xac\xd7\xcdo\xbb:\x1a\x0e\xb7\x89\xa8Y\xf3\t\x1fw\x1b\x95o\xbcD\xf5\xc7\xef\xb1\xed\xf5\xedl{};j\xb5\x9a\xb8\xb8\x18\xba$\xc4\xe1t:1\x96\x96SV^Y\xbf\xdc\xa9\x83C0\xdc\xfd\x00\x86y\xbfF\xa5\x0f\xff1U\xfcq\t\x00\xe5\x93\x89{t5\xd1\xbf^\x86\xe9\xdb/\xa9\xfbj/\xd6\x93G)))\xa5\xa4\xc4\x93\x9e\x16\x02M\\gB\x07]G\xd8\xe8q\x84\x8d\xb8\tU\xc8\xd59\x86\xf7\xa3\x13\xe0\x85:<\x92\x88[\xa6\x13q\x8b\xb2\xe9\xe9\xb6X\x94\xdda!P\xeb\xc3\x11\xbav\x1dF\xeb0\xae\x1a\x01\x97C\x15\x12\x82*\xa4\xf9\x1e\xc4U\xd7\xe3\xa7V\xe0\xa7\xc6\xcf\x04\xfc\xd4\n\xfc\xd4\xf8\x97\'\xc0W> \x08x\n\xe5\xb8|\x0f E\x9b\x94\x82&\xb6\xeds\x84W\x13.\xa9\x9cV\x05\xc0X\x04\xc5\x85\xa0\x9cW(\x00>\x076\xd1\x81\x03\\KheW\xe7\xff\xd05\xbb-\x03}-\x83\x03\x00\xee\xd8\xb4\x85\xc4\xeb\x9a\xe7\x00\xfe\xb7\xc1*%\xb9&%\x7f`\xfcr7\x99\x9b\x9e\x05\xe5t\xe9\x8e\xd6\xda\xf8\xe5\x07\xe8\xe3\xe2\xe9\x94\xe8\xdf\x11\x97\x9f\x12\x16\xb7$\xb4NI\t\xea\x0c\xcd7iZ\x82/\x02.\x01\xec]\xbf\x86\xfd\xaf(\xa1f\xca\xa8\x9b\x19\xb9\xe8a\x00N\xfc\xed}N|\xf8~;\xd5\xbd\xf2pJ\xb0x\x0eZ[+\xeaS\xf4\xfe\x1d$l\x05I \xf2h\xf4M\xe9""\x8e\xac\xc9-\x1f\xba&\xb7|\xa8>6\xeeS\xae\xfe7\x1d\xc8u\x12hs(\xf8\x93\x15V\xa1\xa4\x98\xbc\xa3\xa5\x80\x86\xcdH\x15\xd0\xddO9W\x1b\x0e\xae\xc0\xff\x15\xfe\x8c\x9f\xf1\xff\x1c\xff\x03\xfc\xdaM\x19\xeb\xd9\x83\xc4\x00\x00\x00\x00IEND\xaeB`\x82'

class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.ld_services = ['LeaderTerm', 'LeaderTermDaemon' ]
        self.ld_process = ['LdFileGate.exe', 'LdTerm.exe', 'LdTermDaemon.exe', 'LdTermPlug64.exe', 'LdTermPlug.exe',
                           'LdTermDaemon.exe', 'LdApproval.exe']
        self.ld_process = [p.lower() for p in self.ld_process]

        QApplication.instance().aboutToQuit.connect(self.onApplicationQuit)
        self.createSystray()

    def createSystray(self):
        self.systray = QSystemTrayIcon(self)
        self.systray.show()
        self.systray.setToolTip('制作人：宝乐-质量控制部')

        trayMenu = QMenu()

        start_act = QAction('启动绿盾', triggered=self.startLd, parent=trayMenu)
        start_act.setIcon(self.style().standardIcon(QStyle.SP_MediaPlay))
        trayMenu.addAction(start_act)

        stop_act = QAction('停止绿盾', triggered=self.stopLd, parent=trayMenu)
        stop_act.setToolTip('一般情况下停止绿盾')
        stop_act.setIcon(self.style().standardIcon(QStyle.SP_MediaPause))
        trayMenu.addAction(stop_act)

        trayMenu.addSeparator()
        quit_act = QAction('退出', triggered=QApplication.quit, parent=trayMenu)
        quit_act.setIcon(self.style().standardIcon(QStyle.SP_DialogCloseButton))
        trayMenu.addAction(quit_act)
        self.systray.setContextMenu(trayMenu)

        pix = QPixmap()
        pix.loadFromData(icon_data, 'png')
        icon = QIcon(pix)
        self.systray.setIcon(icon)

    def closeEvent(self, event):
        event.ignore()

    def onApplicationQuit(self):
        self.systray.deleteLater()

    def stopLd(self):
        while True:
            try:
                self.stopLdProcess()
            except Exception:
                break

    def startLd(self):
        while True:
            try:
                self.startLdServices()
            except Exception as e:
                break

    def stopLdProcess(self):
        i = 0
        for process in psutil.process_iter():
            if process.name().lower() in self.ld_process:
                print(process.memory_info())
                process.kill()
                i += 1
        if i == 0:
            raise RuntimeError('No Process Found')

    def stopLdServices(self):
        for service in self.ld_services:
            win32serviceutil.StopService(service)

    def startLdServices(self):
        for service in self.ld_services:
            win32serviceutil.StartService(service)


app = QApplication([])
mainwindow = MainWindow()
mainwindow.hide()
app.exec()